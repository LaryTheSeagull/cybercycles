var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(b.get||b.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var c=0;return $jscomp.iteratorPrototype(function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(a,c){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var b=0,d={next:function(){if(b<a.length){var e=b++;return{value:c(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");var socket=io(),room=location.pathname.slice(1),ctx=canvas.getContext("2d");
document.title="CyberCycles - "+room;canvas.width=canvas.height=Math.min(parent.innerWidth,parent.innerHeight);var cellHeight,cellWidth,teams={},teamColors="#f00 #00f #0f0 #ff0 #f0f #0ff".split(" ");
function drawGrid(a){ctx.strokeStyle=ctx.fillStyle="rgba(24, 202, 230, 0.75)";ctx.shadowColor="rgba(21, 171, 195, 0.5)";ctx.shadowBlur=1;for(var c=0;c<=a.length;c+=1)ctx.beginPath(),ctx.moveTo(0,cellHeight*c),ctx.lineTo(cellHeight*a[0].length,cellHeight*c),ctx.closePath(),ctx.stroke();for(var b=0;b<=a[0].length;b+=1)ctx.beginPath(),ctx.moveTo(cellWidth*c,0),ctx.lineTo(cellWidth*c,cellWidth*a.length),ctx.closePath(),ctx.stroke()}
function drawObstacles(a){ctx.strokeStyle=ctx.fillStyle="rgba(21, 171, 195, 1.0)";for(var c=0;c<a.length;c+=1)for(var b=0;b<a[0].length;b+=1)"#"===a[c][b]&&ctx.fillRect(cellWidth*b,cellHeight*c,cellWidth,cellHeight)}
function drawPlayers(a,c){for(var b=0;b<a.length;b+=1)for(var d=0;d<a[0].length;d+=1)if("X"===a[b][d])ctx.fillStyle="gray",ctx.fillRect(cellWidth*d,cellHeight*b,cellWidth,cellHeight);else if(" "!==a[b][d]&&"#"!==a[b][d]){var e=+a[b][d],f,g;Object.keys(c).forEach(function(a){var b=c[a].indexOf(String(e));-1!==b&&(g=a,f=b)});var h=Object.keys(c).indexOf(g);ctx.fillStyle=teamColors[h%teamColors.length];ctx.globalAlpha=1-.3*f;ctx.fillRect(cellWidth*d,cellHeight*b,cellWidth,cellHeight);ctx.globalAlpha=
1}}socket.on("connect",function(){socket.emit("join",room)});
socket.on("draw",function(a,c){if(!cellHeight||!cellWidth){cellWidth=cellHeight=Math.min(canvas.height/a.length,canvas.width/a[0].length);c.forEach(function(a){teams[a.team]?teams[a.team].push(a.id):teams[a.team]=[a.id]});var b=" | ";Object.keys(teams).forEach(function(a,c){b+='<span style="color: '+teamColors[c%teamColors.length]+'">'+a+"</span> | "});document.getElementById("header").innerHTML=b;ctx.clearRect(0,0,canvas.width,canvas.height);drawGrid(a);drawObstacles(a)}drawPlayers(a,teams)});
socket.on("end",function(a){cellHeight=cellWidth=null;socket.emit("join",room)});socket.on("disconnect",function(){cellHeight=cellWidth=null;socket.emit("join",room)});window.addEventListener("resize",function(){window.location.reload()});
